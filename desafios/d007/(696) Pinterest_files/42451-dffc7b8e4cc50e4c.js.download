"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[42451],{507712:function(t,n,e){var r=e(6637),a=e(826067);n.Z=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};var n=(0,a.mB)(window.location.search),e=n.invite_code;e?r.Z.create("InviteAttributionResource",{invite_code:e}).callCreate():t(n)}},280313:function(t,n,e){e.d(n,{Z:function(){return wt}});var r=e(76911),a=e(317672),i=e(790348);function o(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(!t)return;if("string"==typeof t)return c(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return c(t,n)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function s(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}function u(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}var l=function(t){var n=performance.getEntriesByType("resource").filter((function(t){return t.name.includes("i.pinimg")})).reduce((function(t,n){var e=n.name.replace(".jpg","").split("/");return function(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?s(Object(e),!0).forEach((function(n){u(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):s(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}(u({},e[e.length-1],{downloadSize:n.name.split("/")[3].split("x")[0]}),t)}),{}),e=Array.from(document.getElementsByTagName("img")).map((function(t){var e=t.src.replace(".jpg","").split("/"),r=e[e.length-1];if(n[r]){var i,o=(null===(i=(0,a.rZ)(t))||void 0===i?void 0:i.width)||1,c=n[r].downloadSize;return{fileName:r,renderedSize:o,downloadedSize:c,ratio:c/o}}return{fileName:r,renderedSize:1,downloadedSize:1,ratio:1}})),r=Array.from(document.querySelectorAll('div[role="img"]')).map((function(t){var e=t.style.backgroundImage.split('"')[1].replace(".jpg","").split("/"),r=e[e.length-1];if(n[r]&&t instanceof HTMLDivElement){var i,o=(null===(i=(0,a.rZ)(t))||void 0===i?void 0:i.width)||1,c=n[r].downloadSize;return{fileName:r,renderedSize:o,downloadedSize:c,ratio:c/o}}return{fileName:r,renderedSize:1,downloadedSize:1,ratio:1}}));[].concat(o(e),o(r)).forEach((function(n){var e=n.ratio,r=n.fileName,a=n.downloadedSize;n.ratio>1.05&&(0,i.A9)("checkImageRatio.".concat(t),{count:Math.round(10*e)/10,tags:{fileName:"".concat(a,"_").concat(r)}})}))},f=e(860273),p=e(543059),d=e(607150);function m(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}function y(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?m(Object(e),!0).forEach((function(n){g(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):m(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}function g(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}var v=function(t){var n=t.constraintMap,e=t.initialNavTiming;return y(y(y(y({},t.annotations),(0,d.jh)("constraint_",n)),(0,d.jh)("mark_",(0,p.gQ)())),(0,d.jh)("browser_",y(y({},e?(0,d.D3)(e):{}),(0,d.rX)())))},h=e(358864),b=e(505771),T=e(156381);function S(t){return function(t){if(Array.isArray(t))return A(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(!t)return;if("string"==typeof t)return A(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return A(t,n)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}var w=function(t,n){var e=(0,T.v2)().firstInputDelay;return[].concat(S(t.map((function(t){return(0,b.Z)(t,n)})).filter(Boolean)),S(e?[{name:"fid",id:(0,h.Z)(),parentId:n,startTime:e.startTime,endTime:e.endTime,annotationMap:{},binaryAnnotationMap:{}}]:[]))},I=e(435851),O=e(172071);function _(t){return function(t){if(Array.isArray(t))return j(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(!t)return;if("string"==typeof t)return j(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return j(t,n)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function E(t){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var x=function(t){var n=t.eventPrefix,e=t.endTime,r=t.tags,a=t.resourceArr,i=t.resourceType,o=void 0===i?"allResources":i,c=a.length;if(c>0&&"object"===E(a[0])&&!Array.isArray(a[0])){for(var s=_(a).sort((function(t,n){return t.fetchStart-n.fetchStart})),u=_(a).sort((function(t,n){return t.responseEnd-n.responseEnd})),l=1,f=e/5,p=0;l<=5;){for(var d=0;p<=c-1&&s[p].fetchStart<=f*l;)p+=1,d+=1;O.Z.gauge("".concat(n,".tags.").concat(o,".fetchStartInterval").concat(l,"of5"),d,.2,r),O.Z.gauge("".concat(n,".").concat(o,".fetchStartInterval").concat(l,"of5"),d,.2),l+=1}var m={zeroPercentInFlight:s[0].fetchStart,twentyFivePercentInFlight:s[Math.floor(c/4)].fetchStart,fiftyPercentInFlight:s[2*Math.floor(c/4)].fetchStart,seventyFivePercentInFlight:s[3*Math.floor(c/4)].fetchStart,hundredPercentInFlight:s[c-1].fetchStart,twentyFivePercentComplete:u[Math.floor(c/4)].responseEnd,fiftyPercentComplete:u[2*Math.floor(c/4)].responseEnd,seventyFivePercentComplete:u[3*Math.floor(c/4)].responseEnd,hundredPercentComplete:u[c-1].responseEnd};for(var y in m)m[y]&&(O.Z.timing("".concat(n,".tags.").concat(o,".").concat(y),m[y],.2,r),O.Z.timing("".concat(n,".").concat(o,".").concat(y),m[y],.2))}},M=function(t){var n=t.annotateExperiments,e=t.endTime,r=t.entries,a=t.metricIdSurface,i=t.pwtStaticContext,o="".concat((0,I.Z)(i),".").concat(a),c=[o];n&&n.forEach((function(t){var n=i.getExperimentGroup(t)||"null";c.push("".concat(o,".").concat(t,".").concat(n))}));var s,u={lcpTimingBucket:((s=(0,T.Bn)())<=2500?"Good":s>2500&&s<=4e3?"Needs Improvement":"Poor")||"unknown"},l=Array.from(r.filter((function(t){return"number"==typeof t.encodedBodySize&&t.encodedBodySize>=1e4&&t.responseEnd<=e}))),f=[],p=[],d=[],m=[],y=[];l.forEach((function(t){"img"===t.initiatorType?f.push(t):"css"===t.initiatorType?p.push(t):"script"===t.initiatorType?d.push(t):"xmlhttprequest"===t.initiatorType?m.push(t):"link"===t.initiatorType&&t.name.includes("i.pinimg.com")&&y.push(t)})),c.forEach((function(t){x({eventPrefix:t,endTime:e,tags:u,resourceArr:l}),x({eventPrefix:t,endTime:e,tags:u,resourceArr:f,resourceType:"image"}),x({eventPrefix:t,endTime:e,tags:u,resourceArr:p,resourceType:"css"}),x({eventPrefix:t,endTime:e,tags:u,resourceArr:d,resourceType:"scripts"}),x({eventPrefix:t,endTime:e,tags:u,resourceArr:m,resourceType:"xhr"}),x({eventPrefix:t,endTime:e,tags:u,resourceArr:y,resourceType:"preloadedImage"})}))},P=e(22773),C=e(453821),N=e(638089),D=function(t){var n,e=t.annotateExperiments,r=t.annotations,a=t.binaryAnnotations,i=t.constraintMap,o=t.endTime,c=t.imageTimings,s=t.metricId,u=t.pwtStaticContext,l=t.startTime,p=t.traceId,d=t.spans,m=(0,P.Cg)();"initial_app_load"===s.navigationType&&(n=(0,f.Z)());var y=c.map((function(t){return t.name})),g=m.map((function(t){return(0,C.p)(t,y)})).filter((function(t){return!function(t,n){var e=t.startTime,r=t.responseEnd;return e>n.endTime||!!r&&r<n.startTime||e<n.startTime-100}(t.timing,{startTime:l,endTime:o})}));return"board"!==s.surface&&"pin_closeup"!==s.surface||"initial_app_load"!==s.navigationType||!1!==u.isAuthenticated||M({annotateExperiments:e,endTime:o,entries:m,metricIdSurface:s.surface,pwtStaticContext:u}),{type:"COMPLETE",traceId:p,startTime:l,endTime:o,spans:w(g,p).concat(d),annotationMap:v({constraintMap:i,initialNavTiming:n,annotations:r}),binaryAnnotationMap:(0,N.rA)({annotateExperiments:e,binaryAnnotations:a,entries:m,metricId:s,performanceResources:g,pwtEndTime:o,pwtStaticContext:u})}},R=!1,Z=function(t,n){return t&&n?R?((0,i.H)("duplicated_initial_app_load_surface_pwt"),(0,h.Z)()):(R=!0,n):(0,h.Z)()},B=e(908390),L=e(226464),z=e(515198);function U(t){var n=t.children,e=t.heading;return(0,z.jsxs)("table",{style:{width:"100%"},cellPadding:4,children:[(0,z.jsx)("thead",{children:(0,z.jsx)("tr",{children:(0,z.jsx)("th",{colSpan:2,style:{background:"#efefef"},children:(0,z.jsx)(B.xv,{weight:"bold",align:"center",children:e})})})}),(0,z.jsx)("tbody",{children:n})]})}function k(t){var n=t.name,e=t.children;return(0,z.jsxs)("tr",{children:[(0,z.jsx)("td",{children:(0,z.jsx)(B.xv,{weight:"bold",children:n})}),(0,z.jsx)("td",{children:"string"==typeof e?(0,z.jsx)(B.xv,{children:e}):e})]})}function G(t){var n=t.result;return"ABORT"===n.type?(0,z.jsx)(k,{name:"Abort Reason",children:n.reason}):(0,z.jsxs)(r.Fragment,{children:[(0,z.jsx)(k,{name:"PWT (ms)",children:(0,z.jsx)(B.xv,{align:"end",children:Math.round(n.endTime-n.startTime)})}),(0,z.jsx)(k,{name:"PinTrace",children:(0,z.jsx)(B.xv,{italic:!0,children:(0,z.jsx)(B.rU,{href:"https://pintrace.pinadmin.com/zipkin/traces/".concat(n.traceId.toString(16)),target:"blank",display:"inlineBlock",onClick:function(t){return(0,t.dangerouslyDisableOnNavigation)()},underline:"hover",children:"Open in a new tab"})})})]})}function H(t){var n=t.data,e=n.metricId,r=n.constraints,a=n.constraintMap,i=n.startTime,o=n.result;return(0,z.jsxs)(B.xu,{children:[(0,z.jsxs)(U,{heading:(0,L.KJ)(e),children:[(0,z.jsx)(k,{name:"Thrift Id",children:String((0,L.Rp)(e))}),(0,z.jsx)(k,{name:"Surface",children:e.surface}),(0,z.jsx)(k,{name:"Navigation Type",children:e.navigationType}),(0,z.jsx)(k,{name:"Viewer Authed",children:String(e.isAuthenticated)})]}),(0,z.jsx)(U,{heading:"Constraints",children:r.map((function(t){return(0,z.jsx)(k,{name:t,children:(0,z.jsx)(B.xv,{align:"end",children:a[t]?Math.round(a[t]-i):"pending..."})},"constraint_".concat(t))}))}),(0,z.jsx)(U,{heading:"Result",children:o?(0,z.jsx)(G,{result:o}):(0,z.jsx)(k,{name:"result",children:(0,z.jsx)(B.$j,{accessibilityLabel:"profiling PWT",show:!0})})})]})}var K=e(223815);function F(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==e)return;var r,a,i=[],o=!0,c=!1;try{for(e=e.call(t);!(o=(r=e.next()).done)&&(i.push(r.value),!n||i.length!==n);o=!0);}catch(s){c=!0,a=s}finally{try{o||null==e.return||e.return()}finally{if(c)throw a}}return i}(t,n)||function(t,n){if(!t)return;if("string"==typeof t)return V(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return V(t,n)}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function V(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}var J=function(t){return t.result?"COMPLETE"===t.result.type?"darkGray":"red":"gray"};function $(t){var n=t.data,e=F((0,r.useState)(!1),2),a=e[0],i=e[1];return(0,z.jsx)(K.Z,{children:(0,z.jsxs)(B.mh,{children:[(0,z.jsx)(B.xu,{position:"fixed",margin:3,marginBottom:12,bottom:!0,left:!0,width:50,height:50,dangerouslySetInlineStyle:{__style:{zIndex:2e3}},children:(0,z.jsx)(B.hU,{accessibilityLabel:"PwtDebugger",bgColor:"lightGray",iconColor:J(n),icon:"flash",size:"lg",onClick:function(){return i(!0)}})}),a&&(0,z.jsx)(B.xu,{position:"absolute",dangerouslySetInlineStyle:{__style:{zIndex:2e3}},children:(0,z.jsx)(B.u_,{accessibilityModalLabel:"Pinner Wait Time Debugger Details",heading:"Pinner Wait Time",onDismiss:function(){return i(!1)},footer:null,size:"sm",children:(0,z.jsx)(H,{data:n})})})]})})}var W=e(558775),Y=function(t,n){var e=(0,r.useRef)(t);(0,r.useEffect)((function(){e.current=t}),[t]);var a=(0,r.useRef)(n);(0,r.useEffect)((function(){a.current=n}),[n]),(0,r.useEffect)((function(){return function(){return a.current(e.current)}}),[])};function q(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==e)return;var r,a,i=[],o=!0,c=!1;try{for(e=e.call(t);!(o=(r=e.next()).done)&&(i.push(r.value),!n||i.length!==n);o=!0);}catch(s){c=!0,a=s}finally{try{o||null==e.return||e.return()}finally{if(c)throw a}}return i}(t,n)||function(t,n){if(!t)return;if("string"==typeof t)return Q(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Q(t,n)}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Q(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}var X=function(t,n){var e=q((0,r.useState)(n),2),a=e[0],i=e[1];return{state:a,dispatch:function(n){return i((function(e){return t(e,n)}))}}},tt=e(985271),nt=e(7789),et=e(383434),rt=e(567450),at=e(276602),it=e(198462);function ot(t){return(ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var ct=["children"];function st(t,n){if(null==t)return{};var e,r,a=function(t,n){if(null==t)return{};var e,r,a={},i=Object.keys(t);for(r=0;r<i.length;r++)e=i[r],n.indexOf(e)>=0||(a[e]=t[e]);return a}(t,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)e=i[r],n.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(t,e)&&(a[e]=t[e])}return a}function ut(t){var n=function(t,n){if("object"!==ot(t)||null===t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,n||"default");if("object"!==ot(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"===ot(n)?n:String(n)}function lt(t){return function(t){if(Array.isArray(t))return ft(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(!t)return;if("string"==typeof t)return ft(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return ft(t,n)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ft(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function pt(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}function dt(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?pt(Object(e),!0).forEach((function(n){mt(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):pt(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}function mt(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}var yt=["initial_app_load","client_route_push"],gt=(0,et.X)("PwtSurface"),vt="NavigationComplete",ht="VisuallyComplete",bt=function(t,n){t.isSampled&&(0,W.Z)({metricId:t.metricConfig.metricId,pwtStaticContext:t.metricConfig.pwtStaticContext,result:{type:"ABORT",reason:n}})},Tt=function(t){if(t.metricConfig.constraints.every((function(n){return t.constraintMap[n]}))){var n=Math.max.apply(Math,lt(t.metricConfig.constraints.map((function(n){return t.constraintMap[n]}))));return function(t,n){var e,r=t.metricConfig,a=r.metricId,o=r.pwtStaticContext,c=r.annotateExperiments,s=t.annotations,u=t.binaryAnnotations,f=t.constraintMap,d=t.startTime,m=t.imageTimings,y=t.isSampled,g=t.spans;(0,p.L8)("PWT_Complete_".concat((0,L.KJ)(a)));var v=Z("initial_app_load"===a.navigationType,null===(e=o.serverData)||void 0===e?void 0:e.trace_id),h=D({annotateExperiments:c,annotations:s,binaryAnnotations:u,constraintMap:f,endTime:n,imageTimings:m,metricId:a,pwtStaticContext:o,startTime:d,traceId:v,spans:g});y&&(0,W.Z)({metricId:a,pwtStaticContext:o,result:h});try{l(String(h.binaryAnnotationMap["metricId.surface"].value))}catch(b){(0,i.H)("image_ratio_check_error",{error:b})}return dt(dt({},t),{},{result:h,status:"DONE"})}(t,n)}return t},St=function(t,n){var e=n.constraint,r=n.time,a=(0,L.KJ)(t.metricConfig.metricId);return tt.Z?t.metricConfig.constraints.find((function(t){return t===e}))?t.constraintMap[e]?(gt('constraint "'.concat(e,'" is already complete.')),(0,i.H)("duplicated_constraint_complete",{constraint:e,action:a}),t):(gt('marking constraint "'.concat(e,'" as complete')),(0,p.ZP)("constraint_".concat(e,"_is_complete")),Tt(dt(dt({},t),{},{constraintMap:dt(dt({},t.constraintMap),{},mt({},e,r||tt.Z.now()))}))):(gt('marked constraint "'.concat(e,'" is not a required constraint.')),t):((0,i.H)("missing_window_performance",{action:a}),t)},At=function(t,n){if(gt("dispatch action",n),"INIT_ROUTE"===n.type)return function(t,n){var e=n.metricConfig,r=n.startTime,a=n.isSampled;if("TIMING"===t.status&&r!==t.startTime&&bt(t,"routeUpdatedOnSameSurface"),!e)return{status:"DISABLED",metricConfig:null};var o,c,s,u,l=(0,L.KJ)(e.metricId);return"TIMING"===t.status&&t.startTime===r&&t.constraintMap[vt]?((0,i.H)("duplicated_init_route_action",{action:l}),t):("Other"===e.pwtStaticContext.browserName&&!1===e.metricId.isAuthenticated&&"initial_app_load"===e.metricId.navigationType?((0,i.A9)("TIMING.".concat(l),{tags:{userAgent:null===(o=window)||void 0===o||null===(c=o.navigator)||void 0===c?void 0:c.userAgent}}),(0,i.A9)("TIMING.sampled.".concat(l),{tags:{userAgent:null===(s=window)||void 0===s||null===(u=s.navigator)||void 0===u?void 0:u.userAgent},sampleRate:.5})):((0,i.A9)("TIMING.".concat(l)),(0,i.A9)("TIMING.sampled.".concat(l),{sampleRate:.5})),St({status:"TIMING",metricConfig:e,startTime:r,constraintMap:{},annotations:{},binaryAnnotations:{},imageTimings:[],isSampled:a,spans:[]},{constraint:vt}))}(t,n.payload);if("TIMING"!==t.status)return gt("ignoring action due to invalid state ".concat(t.status),n),t;switch(n.type){case"ABORT":bt(t,n.reason);var e={type:"ABORT",reason:n.reason};return dt(dt({},t),{},{status:"DONE",result:e});case"ANNOTATE":var r=n.payload.name;if(!tt.Z)return t;var a=tt.Z.now();return gt("adding annotation {".concat(r,": ").concat(a,"}")),dt(dt({},t),{},{annotations:dt(dt({},t.annotations),mt({},r,a))});case"BINARY_ANNOTATE":var o=n.payload,c=o.name,s=o.value,u=o.annotationType;return gt("adding binary annotation {".concat(c,": ").concat(s,"}")),dt(dt({},t),{},{binaryAnnotations:dt(dt({},t.binaryAnnotations),mt({},c,{value:s,type:u}))});case"MARK_CONSTRAINT_COMPLETE":return St(t,n.payload);case"REMOVE_CONSTRAINT":return function(t,n){if(!tt.Z){var e=(0,L.KJ)(t.metricConfig.metricId);(0,i.H)("missing_window_performance",{action:e})}gt('removing constraint "'.concat(n,'"'));var r=t.metricConfig.constraints.filter((function(t){return t!==n})),a=t.constraintMap,o=(a[n],st(a,[n].map(ut)));return Tt(dt(dt({},t),{},{constraintMap:o,metricConfig:dt(dt({},t.metricConfig),{},{constraints:r})}))}(t,n.payload);case"SET_SEGMENT":return function(t,n){if(!tt.Z){var e=(0,L.KJ)(t.metricConfig.metricId);(0,i.H)("missing_window_performance",{action:e})}gt('updating pwt segment to "'.concat(n,'"'));var r=dt(dt({},t.metricConfig.metricId),{},{segment:n});return dt(dt({},t),{},{metricConfig:dt(dt({},t.metricConfig),{},{metricId:r})})}(t,n.payload);case"SET_VISUALLY_COMPLETE_RESULT":var l=n.payload.imageTimings;if(0===l.length){bt(t,"visuallyComplete_noImages");return dt(dt({},t),{},{status:"DONE",result:{type:"ABORT",reason:"visuallyComplete_noImages"}})}var f=Math.max.apply(Math,lt(l.map((function(t){return t.responseEnd||0}))));return St(dt(dt({},t),{},{imageTimings:l}),{constraint:ht,time:f});case"ADD_SUBSPAN":var p=t.startTime,d=n.payload,m=d.name,y=d.startTime,g=d.endTime,v=d.annotations,b=d.binaryAnnotations,T=d.parentId;return dt(dt({},t),{},{spans:[].concat(lt(t.spans),[{name:m,id:(0,h.Z)(),startTime:y||p,endTime:g,annotationMap:dt({},v),binaryAnnotationMap:dt({},b),parentId:T}])});case"START_SUBSPAN":return dt(dt({},t),{},{spans:[].concat(lt(t.spans),[{name:n.payload.name,id:(0,h.Z)(),startTime:tt.Z?tt.Z.now():0,endTime:1/0,annotationMap:dt({},n.payload.annotations),binaryAnnotationMap:dt({},n.payload.binaryAnnotations),parentId:n.payload.parentId}])});case"STOP_SUBSPAN":var S=t.spans.findIndex((function(t){return t.name===n.payload.name}));return S>-1?(t.spans[S].endTime=tt.Z?tt.Z.now():0,n.payload.annotations&&(t.spans[S].annotationMap=dt(dt({},t.spans[S].annotationMap),n.payload.annotations)),n.payload.binaryAnnotations&&(t.spans[S].binaryAnnotationMap=dt(dt({},t.spans[S].binaryAnnotationMap),n.payload.binaryAnnotations))):(0,i.H)("invalid_subspan_stop_name",{name:n.payload.name}),t;default:var A=(0,L.KJ)(t.metricConfig.metricId);return(0,i.H)("invalid_pwt_surface_action",{action:A}),t}};function wt(t){var n,e,a,o=t.children,c=st(t,ct),s=(0,it.fM)(),u=function(t){if(!t)return"initial_app_load";switch(t.action){case"PUSH":return"client_route_push";case"REPLACE":return"client_route_replace";default:return null}}(s),l=["seo_web_react18_render","web_react18_render_auth","web_react18_render_unauth","web_duplo_default"].concat(lt(null!==(n=c.annotateExperiments)&&void 0!==n?n:[])),f=function(t){var n=t.surface,e=t.constraints,a=t.segment,i=t.measureGridVisuallyComplete,o=t.annotateExperiments,c=t.customEnabledNavigationTypes,s=t.navigationInfo,u=s.clientNavigation,l=s.navigationType,f=t.sampleRate,p=(0,r.useRef)("NOT_SET"),d=(0,it.N5)(),m=X(At,{status:"DISABLED",metricConfig:null}),y=m.state,g=m.dispatch;if(p.current!==u&&(p.current=u,d)){var v=d.isAuthenticated,h=n&&l&&(c||yt).includes(l)?{metricId:{type:"surface",surface:n,navigationType:l,isAuthenticated:v,segment:a},annotateExperiments:o,constraints:[vt].concat(lt(e||[]),lt(i?[ht]:[])),pwtStaticContext:d}:null;g({type:"INIT_ROUTE",payload:{metricConfig:h,startTime:u?u.time:0,isSampled:!f||Math.random()<f}})}if((0,r.useEffect)((function(){var t=function(t){g({type:"ABORT",reason:t})};rt.Z.onSessionPause(t);var n=function t(){window.removeEventListener("resize",t),g({type:"ABORT",reason:"windowResized"})};return window.addEventListener("resize",n),function(){rt.Z.removePauseListener(t),window.removeEventListener("resize",n)}}),[]),Y(y,(function(t){gt("handling unmount",t),"TIMING"===t.status&&bt(t,"unmount")})),"TIMING"!==y.status||!y.constraintMap[vt])return{state:y,context:null};var b=y.startTime,T=y.metricConfig;return{state:y,context:{id:b,metricId:T.metricId,abort:function(t){return g({type:"ABORT",reason:t})},addAnnotation:function(t){return g({type:"ANNOTATE",payload:{name:t}})},addBinaryAnnotation:function(t,n,e){return g({type:"BINARY_ANNOTATE",payload:{name:t,value:n,annotationType:e}})},setVisuallyCompleteResult:T.constraints.includes(ht)?function(t){return g({type:"SET_VISUALLY_COMPLETE_RESULT",payload:t})}:null,markConstraintComplete:function(t){return g({type:"MARK_CONSTRAINT_COMPLETE",payload:{constraint:t,time:tt.Z?tt.Z.now():0}})},removeConstraint:function(t){return g({type:"REMOVE_CONSTRAINT",payload:t})},setSegment:function(t){return g({type:"SET_SEGMENT",payload:t})},addSubspan:function(t,n,e){return g({type:"ADD_SUBSPAN",payload:{name:t,startTime:n,endTime:e,annotations:arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},binaryAnnotations:arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},parentId:arguments.length>5&&void 0!==arguments[5]?arguments[5]:null}})},startSubspan:function(t){return g({type:"START_SUBSPAN",payload:{name:t,annotations:arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},binaryAnnotations:arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},parentId:arguments.length>3&&void 0!==arguments[3]?arguments[3]:null}})},stopSubspan:function(t){return g({type:"STOP_SUBSPAN",payload:{name:t,annotations:arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},binaryAnnotations:arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},parentId:arguments.length>3&&void 0!==arguments[3]?arguments[3]:null}})}}}}(dt(dt({},c),{},{annotateExperiments:l,navigationInfo:{navigationType:u,clientNavigation:s}})),p=f.state,d=f.context;return e=(0,at.EV)(),a=!!e,(0,r.useEffect)((function(){if(a){var t=null!=e&&e.metricId?(0,L.KJ)(e.metricId):null;(0,i.H)("nested_pwt_surface",{action:t})}}),[a]),(0,z.jsxs)(r.Fragment,{children:[(0,z.jsx)(at.Sb,{value:d,children:o}),nt.DQ&&"DISABLED"!==p.status&&(0,z.jsx)($,{data:{metricId:p.metricConfig.metricId,constraints:p.metricConfig.constraints,constraintMap:p.constraintMap,startTime:p.startTime,result:"DONE"===p.status?p.result:null}})]})}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/42451-dffc7b8e4cc50e4c.js.map